import{Y as e,h as s,L as a,a as t,c as o,w as n,i,o as r,b as c,f as u,g as l,A as d,I as p,M as m}from"./index-C-XsXVfx.js";import{_ as h}from"./uni-forms.DvjnVXVO.js";import{r as f}from"./uni-app.es.DhiN6RXN.js";import{_ as g}from"./uni-captcha.D7fBCAGD.js";import{m as w}from"./login-page.mixin.Czoggf5n.js";import{_}from"./_plugin-vue_export-helper.BCo6x5W8.js";import"./uni-icons.CgipEwkq.js";import"./store.DpSSVhXf.js";const C=e.importObject("uni-id-co",{errorOptions:{type:"toast"}});const b=_({mixins:[w],data:()=>({password:"",username:"",captcha:"",needCaptcha:!1,focusUsername:!1,focusPassword:!1,logo:"/static/logo.png"}),onShow(){document.onkeydown=e=>{var s=e||window.event;s&&13==s.keyCode&&this.pwdLogin()}},methods:{pwdLogin(){if(!this.password.length)return this.focusPassword=!0,s({title:"请输入密码",icon:"none",duration:3e3});if(!this.username.length)return this.focusUsername=!0,s({title:"请输入账号",icon:"none",duration:3e3});if(this.needCaptcha&&4!=this.captcha.length)return this.$refs.captcha.getImageCaptcha(),s({title:"请输入验证码",icon:"none",duration:3e3});let e={password:this.password,captcha:this.captcha};/^1\d{10}$/.test(this.username)?e.mobile=this.username:/@/.test(this.username)?e.email=this.username:e.username=this.username,C.login(e).then((e=>{this.loginSuccess(e)})).catch((e=>{"uni-id-captcha-required"==e.errCode?this.needCaptcha=!0:this.needCaptcha&&this.$refs.captcha.getImageCaptcha()}))},toRegister(){a({url:this.config.isAdmin?"/uni_modules/uni-id-pages/pages/register/register-admin":"/uni_modules/uni-id-pages/pages/register/register",fail:e=>{console.error(e)}})}}},[["render",function(e,s,a,w,_,C){const b=d,x=p,j=f(t("uni-forms"),h),V=f(t("uni-captcha"),g),k=i,y=m;return r(),o(k,{class:"uni-content container"},{default:n((()=>[c(b,{class:"title title-box"},{default:n((()=>[u("用户登录")])),_:1}),c(j,null,{default:n((()=>[c(x,{class:"input-box",type:"text",modelValue:_.username,"onUpdate:modelValue":s[0]||(s[0]=e=>_.username=e),placeholder:"请输入账号",focus:_.focusUsername,onBlur:s[1]||(s[1]=e=>_.focusUsername=!1)},null,8,["modelValue","focus"]),c(x,{class:"input-box",type:"password",modelValue:_.password,"onUpdate:modelValue":s[2]||(s[2]=e=>_.password=e),placeholder:"请输入密码",focus:_.focusPassword,onBlur:s[3]||(s[3]=e=>_.focusPassword=!1)},null,8,["modelValue","focus"])])),_:1}),_.needCaptcha?(r(),o(V,{key:0,focus:"",ref:"captcha",scene:"login-by-pwd",modelValue:_.captcha,"onUpdate:modelValue":s[4]||(s[4]=e=>_.captcha=e)},null,8,["modelValue"])):l("",!0),c(k,{class:"register-link",onClick:s[5]||(s[5]=e=>C.toRegister())},{default:n((()=>[u("注册账号")])),_:1}),c(y,{class:"login-button uni-btn","hover-class":"clicked","hover-stay-time":"200",onClick:C.pwdLogin},{default:n((()=>[u("登录")])),_:1},8,["onClick"])])),_:1})}],["__scopeId","data-v-81be9e6b"]]);export{b as default};
